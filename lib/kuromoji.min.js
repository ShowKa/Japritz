!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;(g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).kuromoji=f()}}((function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({"./loader/NodeDictionaryLoader.js":[function(require,module,exports){var zlib=require("zlibjs/bin/gunzip.min.js"),DictionaryLoader=require("./DictionaryLoader");function BrowserDictionaryLoader(dic_path){DictionaryLoader.apply(this,[dic_path])}BrowserDictionaryLoader.prototype=Object.create(DictionaryLoader.prototype),BrowserDictionaryLoader.prototype.loadArrayBuffer=function(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.onload=function(){200!==this.status&&callback(xhr.statusText,null);var arraybuffer=this.response,gz,typed_array=new zlib.Zlib.Gunzip(new Uint8Array(arraybuffer)).decompress();callback(null,typed_array.buffer)},xhr.onerror=function(err){callback(err,null)},xhr.send()},module.exports=BrowserDictionaryLoader},{"./DictionaryLoader":16,"zlibjs/bin/gunzip.min.js":5}],1:[function(require,module,exports){(function(process,global){
/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
!function(){var async={},previous_async;function noop(){}function identity(v){return v}function toBool(v){return!!v}function notId(v){return!v}var root="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;function only_once(fn){return function(){if(null===fn)throw new Error("Callback was already called.");fn.apply(this,arguments),fn=null}}function _once(fn){return function(){null!==fn&&(fn.apply(this,arguments),fn=null)}}null!=root&&(previous_async=root.async),async.noConflict=function(){return root.async=previous_async,async};var _toString=Object.prototype.toString,_isArray=Array.isArray||function(obj){return"[object Array]"===_toString.call(obj)},_isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj};function _isArrayLike(arr){return _isArray(arr)||"number"==typeof arr.length&&arr.length>=0&&arr.length%1==0}function _arrayEach(arr,iterator){for(var index=-1,length=arr.length;++index<length;)iterator(arr[index],index,arr)}function _map(arr,iterator){for(var index=-1,length=arr.length,result=Array(length);++index<length;)result[index]=iterator(arr[index],index,arr);return result}function _range(count){return _map(Array(count),(function(v,i){return i}))}function _reduce(arr,iterator,memo){return _arrayEach(arr,(function(x,i,a){memo=iterator(memo,x,i,a)})),memo}function _forEachOf(object,iterator){_arrayEach(_keys(object),(function(key){iterator(object[key],key)}))}function _indexOf(arr,item){for(var i=0;i<arr.length;i++)if(arr[i]===item)return i;return-1}var _keys=Object.keys||function(obj){var keys=[];for(var k in obj)obj.hasOwnProperty(k)&&keys.push(k);return keys};function _keyIterator(coll){var i=-1,len,keys;return _isArrayLike(coll)?(len=coll.length,function next(){return++i<len?i:null}):(keys=_keys(coll),len=keys.length,function next(){return++i<len?keys[i]:null})}function _restParam(func,startIndex){return startIndex=null==startIndex?func.length-1:+startIndex,function(){for(var length=Math.max(arguments.length-startIndex,0),rest=Array(length),index=0;index<length;index++)rest[index]=arguments[index+startIndex];switch(startIndex){case 0:return func.call(this,rest);case 1:return func.call(this,arguments[0],rest)}}}function _withoutIndex(iterator){return function(value,index,callback){return iterator(value,callback)}}var _setImmediate="function"==typeof setImmediate&&setImmediate,_delay=_setImmediate?function(fn){_setImmediate(fn)}:function(fn){setTimeout(fn,0)};function _eachOfLimit(limit){return function(obj,iterator,callback){callback=_once(callback||noop);var nextKey=_keyIterator(obj=obj||[]);if(limit<=0)return callback(null);var done=!1,running=0,errored=!1;!function replenish(){if(done&&running<=0)return callback(null);for(;running<limit&&!errored;){var key=nextKey();if(null===key)return done=!0,void(running<=0&&callback(null));running+=1,iterator(obj[key],key,only_once((function(err){running-=1,err?(callback(err),errored=!0):replenish()})))}}()}}function doParallel(fn){return function(obj,iterator,callback){return fn(async.eachOf,obj,iterator,callback)}}function doParallelLimit(fn){return function(obj,limit,iterator,callback){return fn(_eachOfLimit(limit),obj,iterator,callback)}}function doSeries(fn){return function(obj,iterator,callback){return fn(async.eachOfSeries,obj,iterator,callback)}}function _asyncMap(eachfn,arr,iterator,callback){callback=_once(callback||noop);var results=_isArrayLike(arr=arr||[])?[]:{};eachfn(arr,(function(value,index,callback){iterator(value,(function(err,v){results[index]=v,callback(err)}))}),(function(err){callback(err,results)}))}function _filter(eachfn,arr,iterator,callback){var results=[];eachfn(arr,(function(x,index,callback){iterator(x,(function(v){v&&results.push({index:index,value:x}),callback()}))}),(function(){callback(_map(results.sort((function(a,b){return a.index-b.index})),(function(x){return x.value})))}))}function _reject(eachfn,arr,iterator,callback){_filter(eachfn,arr,(function(value,cb){iterator(value,(function(v){cb(!v)}))}),callback)}function _createTester(eachfn,check,getResult){return function(arr,limit,iterator,cb){function done(){cb&&cb(getResult(!1,void 0))}function iteratee(x,_,callback){if(!cb)return callback();iterator(x,(function(v){cb&&check(v)&&(cb(getResult(!0,x)),cb=iterator=!1),callback()}))}arguments.length>3?eachfn(arr,limit,iteratee,done):(cb=iterator,iterator=limit,eachfn(arr,iteratee,done))}}function _findGetResult(v,x){return x}function _parallel(eachfn,tasks,callback){callback=callback||noop;var results=_isArrayLike(tasks)?[]:{};eachfn(tasks,(function(task,key,callback){task(_restParam((function(err,args){args.length<=1&&(args=args[0]),results[key]=args,callback(err)})))}),(function(err){callback(err,results)}))}function _concat(eachfn,arr,fn,callback){var result=[];eachfn(arr,(function(x,index,cb){fn(x,(function(err,y){result=result.concat(y||[]),cb(err)}))}),(function(err){callback(err,result)}))}function _queue(worker,concurrency,payload){if(null==concurrency)concurrency=1;else if(0===concurrency)throw new Error("Concurrency must not be zero");function _insert(q,data,pos,callback){if(null!=callback&&"function"!=typeof callback)throw new Error("task callback must be a function");if(q.started=!0,_isArray(data)||(data=[data]),0===data.length&&q.idle())return async.setImmediate((function(){q.drain()}));_arrayEach(data,(function(task){var item={data:task,callback:callback||noop};pos?q.tasks.unshift(item):q.tasks.push(item),q.tasks.length===q.concurrency&&q.saturated()})),async.setImmediate(q.process)}function _next(q,tasks){return function(){workers-=1;var removed=!1,args=arguments;_arrayEach(tasks,(function(task){_arrayEach(workersList,(function(worker,index){worker!==task||removed||(workersList.splice(index,1),removed=!0)})),task.callback.apply(task,args)})),q.tasks.length+workers===0&&q.drain(),q.process()}}var workers=0,workersList=[],q={tasks:[],concurrency:concurrency,payload:payload,saturated:noop,empty:noop,drain:noop,started:!1,paused:!1,push:function(data,callback){_insert(q,data,!1,callback)},kill:function(){q.drain=noop,q.tasks=[]},unshift:function(data,callback){_insert(q,data,!0,callback)},process:function(){if(!q.paused&&workers<q.concurrency&&q.tasks.length)for(;workers<q.concurrency&&q.tasks.length;){var tasks=q.payload?q.tasks.splice(0,q.payload):q.tasks.splice(0,q.tasks.length),data=_map(tasks,(function(task){return task.data}));0===q.tasks.length&&q.empty(),workers+=1,workersList.push(tasks[0]);var cb=only_once(_next(q,tasks));worker(data,cb)}},length:function(){return q.tasks.length},running:function(){return workers},workersList:function(){return workersList},idle:function(){return q.tasks.length+workers===0},pause:function(){q.paused=!0},resume:function(){if(!1!==q.paused){q.paused=!1;for(var resumeCount=Math.min(q.concurrency,q.tasks.length),w=1;w<=resumeCount;w++)async.setImmediate(q.process)}}};return q}function _console_fn(name){return _restParam((function(fn,args){fn.apply(null,args.concat([_restParam((function(err,args){"object"==typeof console&&(err?console.error&&console.error(err):console[name]&&_arrayEach(args,(function(x){console[name](x)})))}))]))}))}function _times(mapper){return function(count,iterator,callback){mapper(_range(count),iterator,callback)}}function _applyEach(eachfn){return _restParam((function(fns,args){var go=_restParam((function(args){var that=this,callback=args.pop();return eachfn(fns,(function(fn,_,cb){fn.apply(that,args.concat([cb]))}),callback)}));return args.length?go.apply(this,args):go}))}function ensureAsync(fn){return _restParam((function(args){var callback=args.pop();args.push((function(){var innerArgs=arguments;sync?async.setImmediate((function(){callback.apply(null,innerArgs)})):callback.apply(null,innerArgs)}));var sync=!0;fn.apply(this,args),sync=!1}))}"object"==typeof process&&"function"==typeof process.nextTick?async.nextTick=process.nextTick:async.nextTick=_delay,async.setImmediate=_setImmediate?_delay:async.nextTick,async.forEach=async.each=function(arr,iterator,callback){return async.eachOf(arr,_withoutIndex(iterator),callback)},async.forEachSeries=async.eachSeries=function(arr,iterator,callback){return async.eachOfSeries(arr,_withoutIndex(iterator),callback)},async.forEachLimit=async.eachLimit=function(arr,limit,iterator,callback){return _eachOfLimit(limit)(arr,_withoutIndex(iterator),callback)},async.forEachOf=async.eachOf=function(object,iterator,callback){callback=_once(callback||noop);for(var iter=_keyIterator(object=object||[]),key,completed=0;null!=(key=iter());)completed+=1,iterator(object[key],key,only_once(done));function done(err){completed--,err?callback(err):null===key&&completed<=0&&callback(null)}0===completed&&callback(null)},async.forEachOfSeries=async.eachOfSeries=function(obj,iterator,callback){callback=_once(callback||noop);var nextKey=_keyIterator(obj=obj||[]),key=nextKey();function iterate(){var sync=!0;if(null===key)return callback(null);iterator(obj[key],key,only_once((function(err){if(err)callback(err);else{if(null===(key=nextKey()))return callback(null);sync?async.setImmediate(iterate):iterate()}}))),sync=!1}iterate()},async.forEachOfLimit=async.eachOfLimit=function(obj,limit,iterator,callback){_eachOfLimit(limit)(obj,iterator,callback)},async.map=doParallel(_asyncMap),async.mapSeries=doSeries(_asyncMap),async.mapLimit=doParallelLimit(_asyncMap),async.inject=async.foldl=async.reduce=function(arr,memo,iterator,callback){async.eachOfSeries(arr,(function(x,i,callback){iterator(memo,x,(function(err,v){memo=v,callback(err)}))}),(function(err){callback(err,memo)}))},async.foldr=async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,identity).reverse();async.reduce(reversed,memo,iterator,callback)},async.transform=function(arr,memo,iterator,callback){3===arguments.length&&(callback=iterator,iterator=memo,memo=_isArray(arr)?[]:{}),async.eachOf(arr,(function(v,k,cb){iterator(memo,v,k,cb)}),(function(err){callback(err,memo)}))},async.select=async.filter=doParallel(_filter),async.selectLimit=async.filterLimit=doParallelLimit(_filter),async.selectSeries=async.filterSeries=doSeries(_filter),async.reject=doParallel(_reject),async.rejectLimit=doParallelLimit(_reject),async.rejectSeries=doSeries(_reject),async.any=async.some=_createTester(async.eachOf,toBool,identity),async.someLimit=_createTester(async.eachOfLimit,toBool,identity),async.all=async.every=_createTester(async.eachOf,notId,notId),async.everyLimit=_createTester(async.eachOfLimit,notId,notId),async.detect=_createTester(async.eachOf,identity,_findGetResult),async.detectSeries=_createTester(async.eachOfSeries,identity,_findGetResult),async.detectLimit=_createTester(async.eachOfLimit,identity,_findGetResult),async.sortBy=function(arr,iterator,callback){function comparator(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}async.map(arr,(function(x,callback){iterator(x,(function(err,criteria){err?callback(err):callback(null,{value:x,criteria:criteria})}))}),(function(err,results){if(err)return callback(err);callback(null,_map(results.sort(comparator),(function(x){return x.value})))}))},async.auto=function(tasks,concurrency,callback){callback||(callback=concurrency,concurrency=null),callback=_once(callback||noop);var keys=_keys(tasks),remainingTasks=keys.length;if(!remainingTasks)return callback(null);concurrency||(concurrency=remainingTasks);var results={},runningTasks=0,listeners=[];function addListener(fn){listeners.unshift(fn)}function removeListener(fn){var idx=_indexOf(listeners,fn);idx>=0&&listeners.splice(idx,1)}function taskComplete(){remainingTasks--,_arrayEach(listeners.slice(0),(function(fn){fn()}))}addListener((function(){remainingTasks||callback(null,results)})),_arrayEach(keys,(function(k){for(var task=_isArray(tasks[k])?tasks[k]:[tasks[k]],taskCallback=_restParam((function(err,args){if(runningTasks--,args.length<=1&&(args=args[0]),err){var safeResults={};_forEachOf(results,(function(val,rkey){safeResults[rkey]=val})),safeResults[k]=args,callback(err,safeResults)}else results[k]=args,async.setImmediate(taskComplete)})),requires=task.slice(0,task.length-1),len=requires.length,dep;len--;){if(!(dep=tasks[requires[len]]))throw new Error("Has inexistant dependency");if(_isArray(dep)&&_indexOf(dep,k)>=0)throw new Error("Has cyclic dependencies")}function ready(){return runningTasks<concurrency&&_reduce(requires,(function(a,x){return a&&results.hasOwnProperty(x)}),!0)&&!results.hasOwnProperty(k)}function listener(){ready()&&(runningTasks++,removeListener(listener),task[task.length-1](taskCallback,results))}ready()?(runningTasks++,task[task.length-1](taskCallback,results)):addListener(listener)}))},async.retry=function(times,task,callback){var DEFAULT_TIMES=5,DEFAULT_INTERVAL=0,attempts=[],opts={times:DEFAULT_TIMES,interval:DEFAULT_INTERVAL};function parseTimes(acc,t){if("number"==typeof t)acc.times=parseInt(t,10)||DEFAULT_TIMES;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);acc.times=parseInt(t.times,10)||DEFAULT_TIMES,acc.interval=parseInt(t.interval,10)||DEFAULT_INTERVAL}}var length=arguments.length;if(length<1||length>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function wrappedTask(wrappedCallback,wrappedResults){function retryAttempt(task,finalAttempt){return function(seriesCallback){task((function(err,result){seriesCallback(!err||finalAttempt,{err:err,result:result})}),wrappedResults)}}function retryInterval(interval){return function(seriesCallback){setTimeout((function(){seriesCallback(null)}),interval)}}for(;opts.times;){var finalAttempt=!(opts.times-=1);attempts.push(retryAttempt(opts.task,finalAttempt)),!finalAttempt&&opts.interval>0&&attempts.push(retryInterval(opts.interval))}async.series(attempts,(function(done,data){data=data[data.length-1],(wrappedCallback||opts.callback)(data.err,data.result)}))}return length<=2&&"function"==typeof times&&(callback=task,task=times),"function"!=typeof times&&parseTimes(opts,times),opts.callback=callback,opts.task=task,opts.callback?wrappedTask():wrappedTask},async.waterfall=function(tasks,callback){if(callback=_once(callback||noop),!_isArray(tasks)){var err=new Error("First argument to waterfall must be an array of functions");return callback(err)}if(!tasks.length)return callback();function wrapIterator(iterator){return _restParam((function(err,args){if(err)callback.apply(null,[err].concat(args));else{var next=iterator.next();next?args.push(wrapIterator(next)):args.push(callback),ensureAsync(iterator).apply(null,args)}}))}wrapIterator(async.iterator(tasks))()},async.parallel=function(tasks,callback){_parallel(async.eachOf,tasks,callback)},async.parallelLimit=function(tasks,limit,callback){_parallel(_eachOfLimit(limit),tasks,callback)},async.series=function(tasks,callback){_parallel(async.eachOfSeries,tasks,callback)},async.iterator=function(tasks){function makeCallback(index){function fn(){return tasks.length&&tasks[index].apply(null,arguments),fn.next()}return fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null},fn}return makeCallback(0)},async.apply=_restParam((function(fn,args){return _restParam((function(callArgs){return fn.apply(null,args.concat(callArgs))}))})),async.concat=doParallel(_concat),async.concatSeries=doSeries(_concat),async.whilst=function(test,iterator,callback){if(callback=callback||noop,test()){var next=_restParam((function(err,args){err?callback(err):test.apply(this,args)?iterator(next):callback(null)}));iterator(next)}else callback(null)},async.doWhilst=function(iterator,test,callback){var calls=0;return async.whilst((function(){return++calls<=1||test.apply(this,arguments)}),iterator,callback)},async.until=function(test,iterator,callback){return async.whilst((function(){return!test.apply(this,arguments)}),iterator,callback)},async.doUntil=function(iterator,test,callback){return async.doWhilst(iterator,(function(){return!test.apply(this,arguments)}),callback)},async.during=function(test,iterator,callback){callback=callback||noop;var next=_restParam((function(err,args){err?callback(err):(args.push(check),test.apply(this,args))})),check=function(err,truth){err?callback(err):truth?iterator(next):callback(null)};test(check)},async.doDuring=function(iterator,test,callback){var calls=0;async.during((function(next){calls++<1?next(null,!0):test.apply(this,arguments)}),iterator,callback)},async.queue=function(worker,concurrency){var q;return _queue((function(items,cb){worker(items[0],cb)}),concurrency,1)},async.priorityQueue=function(worker,concurrency){function _compareTasks(a,b){return a.priority-b.priority}function _binarySearch(sequence,item,compare){for(var beg=-1,end=sequence.length-1;beg<end;){var mid=beg+(end-beg+1>>>1);compare(item,sequence[mid])>=0?beg=mid:end=mid-1}return beg}function _insert(q,data,priority,callback){if(null!=callback&&"function"!=typeof callback)throw new Error("task callback must be a function");if(q.started=!0,_isArray(data)||(data=[data]),0===data.length)return async.setImmediate((function(){q.drain()}));_arrayEach(data,(function(task){var item={data:task,priority:priority,callback:"function"==typeof callback?callback:noop};q.tasks.splice(_binarySearch(q.tasks,item,_compareTasks)+1,0,item),q.tasks.length===q.concurrency&&q.saturated(),async.setImmediate(q.process)}))}var q=async.queue(worker,concurrency);return q.push=function(data,priority,callback){_insert(q,data,priority,callback)},delete q.unshift,q},async.cargo=function(worker,payload){return _queue(worker,1,payload)},async.log=_console_fn("log"),async.dir=_console_fn("dir"),async.memoize=function(fn,hasher){var memo={},queues={};hasher=hasher||identity;var memoized=_restParam((function memoized(args){var callback=args.pop(),key=hasher.apply(null,args);key in memo?async.setImmediate((function(){callback.apply(null,memo[key])})):key in queues?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat([_restParam((function(args){memo[key]=args;var q=queues[key];delete queues[key];for(var i=0,l=q.length;i<l;i++)q[i].apply(null,args)}))])))}));return memoized.memo=memo,memoized.unmemoized=fn,memoized},async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}},async.times=_times(async.map),async.timesSeries=_times(async.mapSeries),async.timesLimit=function(count,limit,iterator,callback){return async.mapLimit(_range(count),limit,iterator,callback)},async.seq=function(){var fns=arguments;return _restParam((function(args){var that=this,callback=args[args.length-1];"function"==typeof callback?args.pop():callback=noop,async.reduce(fns,args,(function(newargs,fn,cb){fn.apply(that,newargs.concat([_restParam((function(err,nextargs){cb(err,nextargs)}))]))}),(function(err,results){callback.apply(that,[err].concat(results))}))}))},async.compose=function(){return async.seq.apply(null,Array.prototype.reverse.call(arguments))},async.applyEach=_applyEach(async.eachOf),async.applyEachSeries=_applyEach(async.eachOfSeries),async.forever=function(fn,callback){var done=only_once(callback||noop),task=ensureAsync(fn);function next(err){if(err)return done(err);task(next)}next()},async.ensureAsync=ensureAsync,async.constant=_restParam((function(values){var args=[null].concat(values);return function(callback){return callback.apply(this,args)}})),async.wrapSync=async.asyncify=function asyncify(func){return _restParam((function(args){var callback=args.pop(),result;try{result=func.apply(this,args)}catch(e){return callback(e)}_isObject(result)&&"function"==typeof result.then?result.then((function(value){callback(null,value)})).catch((function(err){callback(err.message?err:new Error(err))})):callback(null,result)}))},"object"==typeof module&&module.exports?module.exports=async:root.async=async}()}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],2:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return(resolvedAbsolute?"/":"")+(resolvedPath=normalizeArray(filter(resolvedPath.split("/"),(function(p){return!!p})),!resolvedAbsolute).join("/"))||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return(path=normalizeArray(filter(path.split("/"),(function(p){return!!p})),!isAbsolute).join("/"))||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,(function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p})).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;i<length;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}for(var outputParts=[],i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return(outputParts=outputParts.concat(toParts.slice(samePartsLength))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];return root||dir?(dir&&(dir=dir.substr(0,dir.length-1)),root+dir):"."},exports.basename=function(path,ext){var f=splitPath(path)[2];return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){return splitPath(path)[3]};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return start<0&&(start=str.length+start),str.substr(start,len)}}).call(this,require("_process"))},{_process:3}],3:[function(require,module,exports){var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var timeout=setTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,clearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],4:[function(require,module,exports){!function(){"use strict";var TERM_CHAR="\0",TERM_CODE=0,ROOT_ID=0,NOT_FOUND=-1,BASE_SIGNED=!0,CHECK_SIGNED=!0,BASE_BYTES=4,CHECK_BYTES=4,MEMORY_EXPAND_RATIO=2,newBC=function(initial_size){null==initial_size&&(initial_size=1024);var initBase=function(_base,start,end){for(var i=start;i<end;i++)_base[i]=1-i;if(0<check.array[check.array.length-1]){for(var last_used_id=check.array.length-2;0<check.array[last_used_id];)last_used_id--;_base[start]=-last_used_id}},initCheck=function(_check,start,end){for(var i=start;i<end;i++)_check[i]=-i-1},realloc=function(min_size){var new_size=2*min_size,base_new_array=newArrayBuffer(base.signed,base.bytes,new_size);initBase(base_new_array,base.array.length,new_size),base_new_array.set(base.array),base.array=null,base.array=base_new_array;var check_new_array=newArrayBuffer(check.signed,check.bytes,new_size);initCheck(check_new_array,check.array.length,new_size),check_new_array.set(check.array),check.array=null,check.array=check_new_array},first_unused_node=1,base={signed:!0,bytes:4,array:newArrayBuffer(!0,4,initial_size)},check={signed:!0,bytes:4,array:newArrayBuffer(!0,4,initial_size)};return base.array[0]=1,check.array[0]=0,initBase(base.array,1,base.array.length),initCheck(check.array,1,check.array.length),{getBaseBuffer:function(){return base.array},getCheckBuffer:function(){return check.array},loadBaseBuffer:function(base_buffer){return base.array=base_buffer,this},loadCheckBuffer:function(check_buffer){return check.array=check_buffer,this},size:function(){return Math.max(base.array.length,check.array.length)},getBase:function(index){return base.array.length-1<index?1-index:base.array[index]},getCheck:function(index){return check.array.length-1<index?-index-1:check.array[index]},setBase:function(index,base_value){base.array.length-1<index&&realloc(index),base.array[index]=base_value},setCheck:function(index,check_value){check.array.length-1<index&&realloc(index),check.array[index]=check_value},setFirstUnusedNode:function(index){first_unused_node=index},getFirstUnusedNode:function(){return first_unused_node},shrink:function(){for(var last_index=this.size()-1;!(0<=check.array[last_index]);)last_index--;base.array=base.array.subarray(0,last_index+2),check.array=check.array.subarray(0,last_index+2)},calc:function(){for(var unused_count=0,size=check.array.length,i=0;i<size;i++)check.array[i]<0&&unused_count++;return{all:size,unused:unused_count,efficiency:(size-unused_count)/size}},dump:function(){var dump_base="",dump_check="",i;for(i=0;i<base.array.length;i++)dump_base=dump_base+" "+this.getBase(i);for(i=0;i<check.array.length;i++)dump_check=dump_check+" "+this.getCheck(i);return console.log("base:"+dump_base),console.log("chck:"+dump_check),"base:"+dump_base+" chck:"+dump_check}}};function DoubleArrayBuilder(initial_size){this.bc=newBC(initial_size),this.keys=[]}function DoubleArray(bc){this.bc=bc,this.bc.shrink()}DoubleArrayBuilder.prototype.append=function(key,record){return this.keys.push({k:key,v:record}),this},DoubleArrayBuilder.prototype.build=function(keys,sorted){if(null==keys&&(keys=this.keys),null==keys)return new DoubleArray(this.bc);null==sorted&&(sorted=!1);var buff_keys=keys.map((function(k){return{k:stringToUtf8Bytes(k.k+"\0"),v:k.v}}));return this.keys=sorted?buff_keys:buff_keys.sort((function(k1,k2){for(var b1=k1.k,b2=k2.k,min_length=Math.min(b1.length,b2.length),pos=0;pos<min_length;pos++)if(b1[pos]!==b2[pos])return b1[pos]-b2[pos];return b1.length-b2.length})),buff_keys=null,this._build(0,0,0,this.keys.length),new DoubleArray(this.bc)},DoubleArrayBuilder.prototype._build=function(parent_index,position,start,length){var children_info=this.getChildrenInfo(position,start,length),_base=this.findAllocatableBase(children_info);this.setBC(parent_index,children_info,_base);for(var i=0;i<children_info.length;i+=3){var child_code=children_info[i];if(0!==child_code){var child_start=children_info[i+1],child_len=children_info[i+2],child_index=_base+child_code;this._build(child_index,position+1,child_start,child_len)}}},DoubleArrayBuilder.prototype.getChildrenInfo=function(position,start,length){var current_char=this.keys[start].k[position],i=0,children_info=new Int32Array(3*length);children_info[i++]=current_char,children_info[i++]=start;for(var next_pos=start,start_pos=start;next_pos<start+length;next_pos++){var next_char=this.keys[next_pos].k[position];current_char!==next_char&&(children_info[i++]=next_pos-start_pos,children_info[i++]=next_char,children_info[i++]=next_pos,current_char=next_char,start_pos=next_pos)}return children_info[i++]=next_pos-start_pos,children_info=children_info.subarray(0,i)},DoubleArrayBuilder.prototype.setBC=function(parent_id,children_info,_base){var bc=this.bc,i;for(bc.setBase(parent_id,_base),i=0;i<children_info.length;i+=3){var code=children_info[i],child_id=_base+code,prev_unused_id=-bc.getBase(child_id),next_unused_id=-bc.getCheck(child_id);child_id!==bc.getFirstUnusedNode()?bc.setCheck(prev_unused_id,-next_unused_id):bc.setFirstUnusedNode(next_unused_id),bc.setBase(next_unused_id,-prev_unused_id);var check=parent_id;if(bc.setCheck(child_id,check),0===code){var start_pos=children_info[i+1],value=this.keys[start_pos].v;null==value&&(value=0);var base=-value-1;bc.setBase(child_id,base)}}},DoubleArrayBuilder.prototype.findAllocatableBase=function(children_info){for(var bc=this.bc,_base,curr=bc.getFirstUnusedNode();;)if((_base=curr-children_info[0])<0)curr=-bc.getCheck(curr);else{for(var empty_area_found=!0,i=0;i<children_info.length;i+=3){var code,candidate_id=_base+children_info[i];if(!this.isUnusedNode(candidate_id)){curr=-bc.getCheck(curr),empty_area_found=!1;break}}if(empty_area_found)return _base}},DoubleArrayBuilder.prototype.isUnusedNode=function(index){var bc,check=this.bc.getCheck(index);return 0!==index&&check<0},DoubleArray.prototype.contain=function(key){for(var bc=this.bc,buffer=stringToUtf8Bytes(key+="\0"),parent=0,child=-1,i=0;i<buffer.length;i++){var code=buffer[i];if(-1===(child=this.traverse(parent,code)))return!1;if(bc.getBase(child)<=0)return!0;parent=child}return!1},DoubleArray.prototype.lookup=function(key){for(var buffer=stringToUtf8Bytes(key+="\0"),parent=0,child=-1,i=0;i<buffer.length;i++){var code=buffer[i];if(-1===(child=this.traverse(parent,code)))return-1;parent=child}var base=this.bc.getBase(child);return base<=0?-base-1:-1},DoubleArray.prototype.commonPrefixSearch=function(key){for(var buffer=stringToUtf8Bytes(key),parent=0,child=-1,result=[],i=0;i<buffer.length;i++){var code=buffer[i];if(-1===(child=this.traverse(parent,code)))break;parent=child;var grand_child=this.traverse(child,0);if(-1!==grand_child){var base=this.bc.getBase(grand_child),r={};base<=0&&(r.v=-base-1),r.k=utf8BytesToString(arrayCopy(buffer,0,i+1)),result.push(r)}}return result},DoubleArray.prototype.traverse=function(parent,code){var child=this.bc.getBase(parent)+code;return this.bc.getCheck(child)===parent?child:-1},DoubleArray.prototype.size=function(){return this.bc.size()},DoubleArray.prototype.calc=function(){return this.bc.calc()},DoubleArray.prototype.dump=function(){return this.bc.dump()};var newArrayBuffer=function(signed,bytes,size){if(signed)switch(bytes){case 1:return new Int8Array(size);case 2:return new Int16Array(size);case 4:return new Int32Array(size);default:throw new RangeError("Invalid newArray parameter element_bytes:"+bytes)}else switch(bytes){case 1:return new Uint8Array(size);case 2:return new Uint16Array(size);case 4:return new Uint32Array(size);default:throw new RangeError("Invalid newArray parameter element_bytes:"+bytes)}},arrayCopy=function(src,src_offset,length){var buffer=new ArrayBuffer(length),dstU8=new Uint8Array(buffer,0,length),srcU8=src.subarray(src_offset,length);return dstU8.set(srcU8),dstU8},stringToUtf8Bytes=function(str){for(var bytes=new Uint8Array(new ArrayBuffer(4*str.length)),i=0,j=0;i<str.length;){var unicode_code,utf16_code=str.charCodeAt(i++);if(utf16_code>=55296&&utf16_code<=56319){var upper=utf16_code,lower=str.charCodeAt(i++);if(!(lower>=56320&&lower<=57343))return null;unicode_code=1024*(upper-55296)+65536+(lower-56320)}else unicode_code=utf16_code;unicode_code<128?bytes[j++]=unicode_code:unicode_code<2048?(bytes[j++]=unicode_code>>>6|192,bytes[j++]=63&unicode_code|128):unicode_code<65536?(bytes[j++]=unicode_code>>>12|224,bytes[j++]=unicode_code>>6&63|128,bytes[j++]=63&unicode_code|128):unicode_code<1<<21&&(bytes[j++]=unicode_code>>>18|240,bytes[j++]=unicode_code>>12&63|128,bytes[j++]=unicode_code>>6&63|128,bytes[j++]=63&unicode_code|128)}return bytes.subarray(0,j)},utf8BytesToString=function(bytes){for(var str="",code,b1,b2,b3,b4,upper,lower,i=0;i<bytes.length;)(code=(b1=bytes[i++])<128?b1:b1>>5==6?(31&b1)<<6|63&(b2=bytes[i++]):b1>>4==14?(15&b1)<<12|(63&(b2=bytes[i++]))<<6|63&(b3=bytes[i++]):(7&b1)<<18|(63&(b2=bytes[i++]))<<12|(63&(b3=bytes[i++]))<<6|63&(b4=bytes[i++]))<65536?str+=String.fromCharCode(code):(upper=55296|(code-=65536)>>10,lower=56320|1023&code,str+=String.fromCharCode(upper,lower));return str},doublearray={builder:function(initial_size){return new DoubleArrayBuilder(initial_size)},load:function(base_buffer,check_buffer){var bc=newBC(0);return bc.loadBaseBuffer(base_buffer),bc.loadCheckBuffer(check_buffer),new DoubleArray(bc)}};void 0===module?window.doublearray=doublearray:module.exports=doublearray}()},{}],5:[function(require,module,exports){
/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function(){"use strict";function n(e){throw e}var q=void 0,aa=this;function r(e,c){var d=e.split("."),b=aa,a;!(d[0]in b)&&b.execScript&&b.execScript("var "+d[0]);for(;d.length&&(a=d.shift());)d.length||c===q?b=b[a]?b[a]:b[a]={}:b[a]=c}var u="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView,v;for(new(u?Uint8Array:Array)(256),v=0;256>v;++v)for(var w,ba=7,w=(w=v)>>>1;w;w>>>=1)--ba;function x(e,c,d){var b,a="number"==typeof c?c:c=0,f="number"==typeof d?d:e.length;for(b=-1,a=7&f;a--;++c)b=b>>>8^z[255&(b^e[c])];for(a=f>>3;a--;c+=8)b=(b=(b=(b=(b=(b=(b=(b=b>>>8^z[255&(b^e[c])])>>>8^z[255&(b^e[c+1])])>>>8^z[255&(b^e[c+2])])>>>8^z[255&(b^e[c+3])])>>>8^z[255&(b^e[c+4])])>>>8^z[255&(b^e[c+5])])>>>8^z[255&(b^e[c+6])])>>>8^z[255&(b^e[c+7])];return(4294967295^b)>>>0}var A=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],z=u?new Uint32Array(A):A;function B(){}function D(e){var c=e.length,d=0,b=Number.POSITIVE_INFINITY,a,f,g,k,m,p,t,h,l,y;for(h=0;h<c;++h)e[h]>d&&(d=e[h]),e[h]<b&&(b=e[h]);for(a=1<<d,f=new(u?Uint32Array:Array)(a),g=1,k=0,m=2;g<=d;){for(h=0;h<c;++h)if(e[h]===g){for(p=0,t=k,l=0;l<g;++l)p=p<<1|1&t,t>>=1;for(y=g<<16|h,l=p;l<a;l+=m)f[l]=y;++k}++g,k<<=1,m<<=1}return[f,d,b]}B.prototype.getName=function(){return this.name},B.prototype.getData=function(){return this.data},B.prototype.H=function(){return this.I},r("Zlib.GunzipMember",B),r("Zlib.GunzipMember.prototype.getName",B.prototype.getName),r("Zlib.GunzipMember.prototype.getData",B.prototype.getData),r("Zlib.GunzipMember.prototype.getMtime",B.prototype.H);var E=[],F;for(F=0;288>F;F++)switch(!0){case 143>=F:E.push([F+48,8]);break;case 255>=F:E.push([F-144+400,9]);break;case 279>=F:E.push([F-256+0,7]);break;case 287>=F:E.push([F-280+192,8]);break;default:n("invalid literal: "+F)}var ca=function(){function e(a){switch(!0){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:n("invalid length: "+a)}}var c=[],d,b;for(d=3;258>=d;d++)b=e(d),c[d]=b[2]<<24|b[1]<<16|b[0];return c}();function G(e,c){switch(this.i=[],this.j=32768,this.d=this.f=this.c=this.n=0,this.input=u?new Uint8Array(e):e,this.o=!1,this.k=H,this.z=!1,!c&&(c={})||(c.index&&(this.c=c.index),c.bufferSize&&(this.j=c.bufferSize),c.bufferType&&(this.k=c.bufferType),c.resize&&(this.z=c.resize)),this.k){case I:this.a=32768,this.b=new(u?Uint8Array:Array)(32768+this.j+258);break;case H:this.a=0,this.b=new(u?Uint8Array:Array)(this.j),this.e=this.F,this.q=this.B,this.l=this.D;break;default:n(Error("invalid inflate mode"))}}u&&new Uint32Array(ca);var I=0,H=1;G.prototype.g=function(){for(;!this.o;){var e=J(this,3);switch(1&e&&(this.o=!0),e>>>=1){case 0:var c=this.input,d=this.c,b=this.b,a=this.a,f=c.length,g=q,k=q,m=b.length,p=q;switch(this.d=this.f=0,d+1>=f&&n(Error("invalid uncompressed block header: LEN")),g=c[d++]|c[d++]<<8,d+1>=f&&n(Error("invalid uncompressed block header: NLEN")),g===~(k=c[d++]|c[d++]<<8)&&n(Error("invalid uncompressed block header: length verify")),d+g>c.length&&n(Error("input buffer is broken")),this.k){case I:for(;a+g>b.length;){if(g-=p=m-a,u)b.set(c.subarray(d,d+p),a),a+=p,d+=p;else for(;p--;)b[a++]=c[d++];this.a=a,b=this.e(),a=this.a}break;case H:for(;a+g>b.length;)b=this.e({t:2});break;default:n(Error("invalid inflate mode"))}if(u)b.set(c.subarray(d,d+g),a),a+=g,d+=g;else for(;g--;)b[a++]=c[d++];this.c=d,this.a=a,this.b=b;break;case 1:this.l(da,ea);break;case 2:fa(this);break;default:n(Error("unknown BTYPE: "+e))}}return this.q()};var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=u?new Uint16Array(K):K,N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],O=u?new Uint16Array(N):N,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],Q=u?new Uint8Array(P):P,R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ga=u?new Uint16Array(R):R,ha=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],U=u?new Uint8Array(ha):ha,V=new(u?Uint8Array:Array)(288),W,ia;for(W=0,ia=V.length;W<ia;++W)V[W]=143>=W?8:255>=W?9:279>=W?7:8;var da=D(V),X=new(u?Uint8Array:Array)(30),Y,ja;for(Y=0,ja=X.length;Y<ja;++Y)X[Y]=5;var ea=D(X);function J(e,c){for(var d=e.f,b=e.d,a=e.input,f=e.c,g=a.length,k;b<c;)f>=g&&n(Error("input buffer is broken")),d|=a[f++]<<b,b+=8;return k=d&(1<<c)-1,e.f=d>>>c,e.d=b-c,e.c=f,k}function Z(e,c){for(var d=e.f,b=e.d,a=e.input,f=e.c,g=a.length,k=c[0],m=c[1],p,t;b<m&&!(f>=g);)d|=a[f++]<<b,b+=8;return t=(p=k[d&(1<<m)-1])>>>16,e.f=d>>t,e.d=b-t,e.c=f,65535&p}function fa(e){function c(a,c,b){var d,e=this.w,f,g;for(g=0;g<a;)switch(d=Z(this,c),d){case 16:for(f=3+J(this,2);f--;)b[g++]=e;break;case 17:for(f=3+J(this,3);f--;)b[g++]=0;e=0;break;case 18:for(f=11+J(this,7);f--;)b[g++]=0;e=0;break;default:e=b[g++]=d}return this.w=e,b}var d=J(e,5)+257,b=J(e,5)+1,a=J(e,4)+4,f=new(u?Uint8Array:Array)(L.length),g,k,m,p;for(p=0;p<a;++p)f[L[p]]=J(e,3);if(!u)for(p=a,a=f.length;p<a;++p)f[L[p]]=0;g=D(f),k=new(u?Uint8Array:Array)(d),m=new(u?Uint8Array:Array)(b),e.w=0,e.l(D(c.call(e,d,g,k)),D(c.call(e,b,g,m)))}function $(e){this.input=e,this.c=0,this.m=[],this.s=!1}G.prototype.l=function(e,c){var d=this.b,b=this.a;this.r=e;for(var a=d.length-258,f,g,k,m;256!==(f=Z(this,e));)if(256>f)b>=a&&(this.a=b,d=this.e(),b=this.a),d[b++]=f;else for(m=O[g=f-257],0<Q[g]&&(m+=J(this,Q[g])),f=Z(this,c),k=ga[f],0<U[f]&&(k+=J(this,U[f])),b>=a&&(this.a=b,d=this.e(),b=this.a);m--;)d[b]=d[b++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=b},G.prototype.D=function(e,c){var d=this.b,b=this.a;this.r=e;for(var a=d.length,f,g,k,m;256!==(f=Z(this,e));)if(256>f)b>=a&&(a=(d=this.e()).length),d[b++]=f;else for(m=O[g=f-257],0<Q[g]&&(m+=J(this,Q[g])),f=Z(this,c),k=ga[f],0<U[f]&&(k+=J(this,U[f])),b+m>a&&(a=(d=this.e()).length);m--;)d[b]=d[b++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=b},G.prototype.e=function(){var e=new(u?Uint8Array:Array)(this.a-32768),c=this.a-32768,d,b,a=this.b;if(u)e.set(a.subarray(32768,e.length));else for(d=0,b=e.length;d<b;++d)e[d]=a[d+32768];if(this.i.push(e),this.n+=e.length,u)a.set(a.subarray(c,c+32768));else for(d=0;32768>d;++d)a[d]=a[c+d];return this.a=32768,a},G.prototype.F=function(e){var c,d=this.input.length/this.c+1|0,b,a,f,g=this.input,k=this.b;return e&&("number"==typeof e.t&&(d=e.t),"number"==typeof e.A&&(d+=e.A)),2>d?a=(f=(b=(g.length-this.c)/this.r[2])/2*258|0)<k.length?k.length+f:k.length<<1:a=k.length*d,u?(c=new Uint8Array(a)).set(k):c=k,this.b=c},G.prototype.q=function(){var e=0,c=this.b,d=this.i,b,a=new(u?Uint8Array:Array)(this.n+(this.a-32768)),f,g,k,m;if(0===d.length)return u?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);for(f=0,g=d.length;f<g;++f)for(k=0,m=(b=d[f]).length;k<m;++k)a[e++]=b[k];for(f=32768,g=this.a;f<g;++f)a[e++]=c[f];return this.i=[],this.buffer=a},G.prototype.B=function(){var e,c=this.a;return u?this.z?(e=new Uint8Array(c)).set(this.b.subarray(0,c)):e=this.b.subarray(0,c):(this.b.length>c&&(this.b.length=c),e=this.b),this.buffer=e},$.prototype.G=function(){return this.s||this.g(),this.m.slice()},$.prototype.g=function(){for(var e=this.input.length;this.c<e;){var c=new B,d=q,b=q,a=q,f=q,g=q,k=q,m=q,p=q,t=q,h=this.input,l=this.c;switch(c.u=h[l++],c.v=h[l++],(31!==c.u||139!==c.v)&&n(Error("invalid file signature:"+c.u+","+c.v)),c.p=h[l++],c.p){case 8:break;default:n(Error("unknown compression method: "+c.p))}if(c.h=h[l++],p=h[l++]|h[l++]<<8|h[l++]<<16|h[l++]<<24,c.I=new Date(1e3*p),c.O=h[l++],c.N=h[l++],0<(4&c.h)&&(c.J=h[l++]|h[l++]<<8,l+=c.J),0<(8&c.h)){for(m=[],k=0;0<(g=h[l++]);)m[k++]=String.fromCharCode(g);c.name=m.join("")}if(0<(16&c.h)){for(m=[],k=0;0<(g=h[l++]);)m[k++]=String.fromCharCode(g);c.K=m.join("")}0<(2&c.h)&&(c.C=65535&x(h,0,l),c.C!==(h[l++]|h[l++]<<8)&&n(Error("invalid header crc16"))),d=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24,h.length-l-4-4<512*d&&(f=d),b=new G(h,{index:l,bufferSize:f}),c.data=a=b.g(),l=b.c,c.L=t=(h[l++]|h[l++]<<8|h[l++]<<16|h[l++]<<24)>>>0,x(a,q,q)!==t&&n(Error("invalid CRC-32 checksum: 0x"+x(a,q,q).toString(16)+" / 0x"+t.toString(16))),c.M=d=(h[l++]|h[l++]<<8|h[l++]<<16|h[l++]<<24)>>>0,(4294967295&a.length)!==d&&n(Error("invalid input size: "+(4294967295&a.length)+" / "+d)),this.m.push(c),this.c=l}this.s=!0;var y=this.m,s,M,S=0,T=0,C;for(s=0,M=y.length;s<M;++s)T+=y[s].data.length;if(u)for(C=new Uint8Array(T),s=0;s<M;++s)C.set(y[s].data,S),S+=y[s].data.length;else{for(C=[],s=0;s<M;++s)C[s]=y[s].data;C=Array.prototype.concat.apply([],C)}return C},r("Zlib.Gunzip",$),r("Zlib.Gunzip.prototype.decompress",$.prototype.g),r("Zlib.Gunzip.prototype.getMembers",$.prototype.G)}).call(this)},{}],6:[function(require,module,exports){"use strict";var ViterbiBuilder=require("./viterbi/ViterbiBuilder.js"),ViterbiSearcher=require("./viterbi/ViterbiSearcher.js"),IpadicFormatter=require("./util/IpadicFormatter.js"),PUNCTUATION=/、|。/;function Tokenizer(dic){this.token_info_dictionary=dic.token_info_dictionary,this.unknown_dictionary=dic.unknown_dictionary,this.viterbi_builder=new ViterbiBuilder(dic),this.viterbi_searcher=new ViterbiSearcher(dic.connection_costs),this.formatter=new IpadicFormatter}Tokenizer.splitByPunctuation=function(input){for(var sentences=[],tail=input;""!==tail;){var index=tail.search(PUNCTUATION);if(index<0){sentences.push(tail);break}sentences.push(tail.substring(0,index+1)),tail=tail.substring(index+1)}return sentences},Tokenizer.prototype.tokenize=function(text){for(var sentences=Tokenizer.splitByPunctuation(text),tokens=[],i=0;i<sentences.length;i++){var sentence=sentences[i];this.tokenizeForSentence(sentence,tokens)}return tokens},Tokenizer.prototype.tokenizeForSentence=function(sentence,tokens){null==tokens&&(tokens=[]);for(var lattice=this.getLattice(sentence),best_path=this.viterbi_searcher.search(lattice),j=0;j<best_path.length;j++){var node=best_path[j],token,features,features_line;"KNOWN"===node.type?(features=null==(features_line=this.token_info_dictionary.getFeatures(node.name))?[]:features_line.split(","),token=this.formatter.formatEntry(node.name,node.start_pos,node.type,features)):"UNKNOWN"===node.type?(features=null==(features_line=this.unknown_dictionary.getFeatures(node.name))?[]:features_line.split(","),token=this.formatter.formatUnknownEntry(node.name,node.start_pos,node.type,features,node.surface_form)):token=this.formatter.formatEntry(node.name,node.start_pos,node.type,[]),tokens.push(token)}return tokens},Tokenizer.prototype.getLattice=function(text){return this.viterbi_builder.build(text)},module.exports=Tokenizer},{"./util/IpadicFormatter.js":19,"./viterbi/ViterbiBuilder.js":21,"./viterbi/ViterbiSearcher.js":24}],7:[function(require,module,exports){"use strict";var Tokenizer=require("./Tokenizer.js"),DictionaryLoader=require("./loader/NodeDictionaryLoader.js");function TokenizerBuilder(option){null!=option.dicPath?this.dic_path=option.dicPath:this.dic_path="dict/"}TokenizerBuilder.prototype.build=function(callback){var loader;new DictionaryLoader(this.dic_path).load((function(err,dic){callback(err,new Tokenizer(dic))}))},module.exports=TokenizerBuilder},{"./Tokenizer.js":6,"./loader/NodeDictionaryLoader.js":"./loader/NodeDictionaryLoader.js"}],8:[function(require,module,exports){"use strict";function CharacterClass(class_id,class_name,is_always_invoke,is_grouping,max_length){this.class_id=class_id,this.class_name=class_name,this.is_always_invoke=is_always_invoke,this.is_grouping=is_grouping,this.max_length=max_length}module.exports=CharacterClass},{}],9:[function(require,module,exports){"use strict";var InvokeDefinitionMap=require("./InvokeDefinitionMap.js"),CharacterClass=require("./CharacterClass.js"),SurrogateAwareString=require("../util/SurrogateAwareString.js"),DEFAULT_CATEGORY="DEFAULT",RETURN_PATTERN=/\r|\n|\r\n/,CATEGORY_DEF_PATTERN=/^(\w+)\s+(\d)\s+(\d)\s+(\d)/,CATEGORY_MAPPING_PATTERN=/^(0x[0-9A-F]{4})(?:\s+([^#\s]+))(?:\s+([^#\s]+))*/,RANGE_CATEGORY_MAPPING_PATTERN=/^(0x[0-9A-F]{4})\.\.(0x[0-9A-F]{4})(?:\s+([^#\s]+))(?:\s+([^#\s]+))*/;function CharacterDefinition(){this.character_category_map=new Uint8Array(65536),this.compatible_category_map=new Uint32Array(65536),this.invoke_definition_map=null}CharacterDefinition.load=function(cat_map_buffer,compat_cat_map_buffer,invoke_def_buffer){var char_def=new CharacterDefinition;return char_def.character_category_map=cat_map_buffer,char_def.compatible_category_map=compat_cat_map_buffer,char_def.invoke_definition_map=InvokeDefinitionMap.load(invoke_def_buffer),char_def},CharacterDefinition.readCharacterDefinition=function(text){for(var lines=text.split(RETURN_PATTERN),line,character_category_definition=[],category_mapping=[],i=0;i<lines.length;i++)if(null!=(line=lines[i])){var parsed_category_def=CATEGORY_DEF_PATTERN.exec(line);if(null==parsed_category_def){var parsed_category_mapping=CATEGORY_MAPPING_PATTERN.exec(line);if(null!=parsed_category_mapping){var mapping=CharacterDefinition.parseCategoryMapping(parsed_category_mapping);category_mapping.push(mapping)}var parsed_range_category_mapping=RANGE_CATEGORY_MAPPING_PATTERN.exec(line);if(null!=parsed_range_category_mapping){var range_mapping=CharacterDefinition.parseRangeCategoryMapping(parsed_range_category_mapping);category_mapping.push(range_mapping)}}else{var class_id=character_category_definition.length,char_class=CharacterDefinition.parseCharCategory(class_id,parsed_category_def);if(null==char_class)continue;character_category_definition.push(char_class)}}var char_def=new CharacterDefinition;return char_def.invoke_definition_map=new InvokeDefinitionMap,char_def.invoke_definition_map.init(character_category_definition),char_def.initCategoryMappings(category_mapping),char_def},CharacterDefinition.parseCharCategory=function(class_id,parsed_category_def){var category=parsed_category_def[1],invoke=parseInt(parsed_category_def[2]),grouping=parseInt(parsed_category_def[3]),max_length=parseInt(parsed_category_def[4]),is_invoke,is_grouping;return!isFinite(invoke)||0!==invoke&&1!==invoke?(console.log("char.def parse error. INVOKE is 0 or 1 in:"+invoke),null):!isFinite(grouping)||0!==grouping&&1!==grouping?(console.log("char.def parse error. GROUP is 0 or 1 in:"+grouping),null):!isFinite(max_length)||max_length<0?(console.log("char.def parse error. LENGTH is 1 to n:"+max_length),null):new CharacterClass(class_id,category,1===invoke,1===grouping,max_length)},CharacterDefinition.parseCategoryMapping=function(parsed_category_mapping){var start=parseInt(parsed_category_mapping[1]),default_category=parsed_category_mapping[2],compatible_category=3<parsed_category_mapping.length?parsed_category_mapping.slice(3):[];return(!isFinite(start)||start<0||start>65535)&&console.log("char.def parse error. CODE is invalid:"+start),{start:start,default:default_category,compatible:compatible_category}},CharacterDefinition.parseRangeCategoryMapping=function(parsed_category_mapping){var start=parseInt(parsed_category_mapping[1]),end=parseInt(parsed_category_mapping[2]),default_category=parsed_category_mapping[3],compatible_category=4<parsed_category_mapping.length?parsed_category_mapping.slice(4):[];return(!isFinite(start)||start<0||start>65535)&&console.log("char.def parse error. CODE is invalid:"+start),(!isFinite(end)||end<0||end>65535)&&console.log("char.def parse error. CODE is invalid:"+end),{start:start,end:end,default:default_category,compatible:compatible_category}},CharacterDefinition.prototype.initCategoryMappings=function(category_mapping){var code_point;if(null!=category_mapping)for(var i=0;i<category_mapping.length;i++){var mapping=category_mapping[i],end=mapping.end||mapping.start;for(code_point=mapping.start;code_point<=end;code_point++){this.character_category_map[code_point]=this.invoke_definition_map.lookup(mapping.default);for(var j=0;j<mapping.compatible.length;j++){var bitset=this.compatible_category_map[code_point],compatible_category=mapping.compatible[j];if(null!=compatible_category){var class_id=this.invoke_definition_map.lookup(compatible_category),class_id_bit;if(null!=class_id)bitset|=1<<class_id,this.compatible_category_map[code_point]=bitset}}}}var default_id=this.invoke_definition_map.lookup("DEFAULT");if(null!=default_id)for(code_point=0;code_point<this.character_category_map.length;code_point++)0===this.character_category_map[code_point]&&(this.character_category_map[code_point]=1<<default_id)},CharacterDefinition.prototype.lookupCompatibleCategory=function(ch){var classes=[],code=ch.charCodeAt(0),integer;if(code<this.compatible_category_map.length&&(integer=this.compatible_category_map[code]),null==integer||0===integer)return classes;for(var bit=0;bit<32;bit++)if(integer<<31-bit>>>31==1){var character_class=this.invoke_definition_map.getCharacterClass(bit);if(null==character_class)continue;classes.push(character_class)}return classes},CharacterDefinition.prototype.lookup=function(ch){var class_id,code=ch.charCodeAt(0);return SurrogateAwareString.isSurrogatePair(ch)?class_id=this.invoke_definition_map.lookup("DEFAULT"):code<this.character_category_map.length&&(class_id=this.character_category_map[code]),null==class_id&&(class_id=this.invoke_definition_map.lookup("DEFAULT")),this.invoke_definition_map.getCharacterClass(class_id)},module.exports=CharacterDefinition},{"../util/SurrogateAwareString.js":20,"./CharacterClass.js":8,"./InvokeDefinitionMap.js":12}],10:[function(require,module,exports){"use strict";function ConnectionCosts(initial_size){this.dimension=0,this.buffer=new Int16Array(initial_size)}ConnectionCosts.prototype.put=function(forward_id,backward_id,cost){isFinite(forward_id)||console.log(forward_id+" "+backward_id+" "+cost);var index=forward_id*this.dimension+backward_id;if(this.buffer.length<index+1)throw"ConnectionCosts buffer overflow";this.buffer[index]=cost},ConnectionCosts.prototype.get=function(forward_id,backward_id){var index=forward_id*this.dimension+backward_id;if(this.buffer.length<index+1)throw"ConnectionCosts buffer overflow";return this.buffer[index]},ConnectionCosts.prototype.loadConnectionCosts=function(connection_costs_buffer){this.dimension=1316,this.buffer=connection_costs_buffer},ConnectionCosts.build=function(matrix_text){var rows=matrix_text.split(/\n/).map((function(row){return row.split(" ")})),backward_size=rows[0][1],costs=new ConnectionCosts(backward_size*backward_size);costs.dimension=backward_size;for(var i=1;i<rows.length;i++)if(!(rows[i].length<3)){var forward_id=parseInt(rows[i][0]),backward_id=parseInt(rows[i][1]),cost=parseInt(rows[i][2]);(forward_id<0||backward_id<0)&&console.log("Error in:"+rows[i]),costs.put(forward_id,backward_id,cost)}return costs},module.exports=ConnectionCosts},{}],11:[function(require,module,exports){"use strict";var doublearray=require("doublearray"),TokenInfoDictionary=require("./TokenInfoDictionary.js"),ConnectionCosts=require("./ConnectionCosts.js"),UnknownDictionary=require("./UnknownDictionary.js");function DynamicDictionaries(trie,token_info_dictionary,connection_costs,unknown_dictionary){this.trie=null!=trie?trie:doublearray.builder(0).build([{k:"",v:1}]),this.token_info_dictionary=null!=token_info_dictionary?token_info_dictionary:new TokenInfoDictionary,this.connection_costs=null!=connection_costs?connection_costs:new ConnectionCosts(0),this.unknown_dictionary=null!=unknown_dictionary?unknown_dictionary:new UnknownDictionary}DynamicDictionaries.prototype.loadTrie=function(base_buffer,check_buffer){return this.trie=doublearray.load(base_buffer,check_buffer),this},DynamicDictionaries.prototype.loadTokenInfoDictionaries=function(token_info_buffer,pos_buffer,target_map_buffer){return this.token_info_dictionary.loadDictionary(token_info_buffer),this.token_info_dictionary.loadPosVector(pos_buffer),this.token_info_dictionary.loadTargetMap(target_map_buffer),this},DynamicDictionaries.prototype.loadConnectionCosts=function(cc_buffer){return this.connection_costs.loadConnectionCosts(cc_buffer),this},DynamicDictionaries.prototype.loadUnknownDictionaries=function(unk_buffer,unk_pos_buffer,unk_map_buffer,cat_map_buffer,compat_cat_map_buffer,invoke_def_buffer){return this.unknown_dictionary.loadUnknownDictionaries(unk_buffer,unk_pos_buffer,unk_map_buffer,cat_map_buffer,compat_cat_map_buffer,invoke_def_buffer),this},module.exports=DynamicDictionaries},{"./ConnectionCosts.js":10,"./TokenInfoDictionary.js":13,"./UnknownDictionary.js":14,doublearray:4}],12:[function(require,module,exports){"use strict";var ByteBuffer=require("../util/ByteBuffer.js"),CharacterClass=require("./CharacterClass.js");function InvokeDefinitionMap(){this.map=[],this.lookup_table={}}InvokeDefinitionMap.load=function(invoke_def_buffer){for(var invoke_def=new InvokeDefinitionMap,character_category_definition=[],buffer=new ByteBuffer(invoke_def_buffer);buffer.position+1<buffer.size();){var class_id=character_category_definition.length,is_always_invoke=buffer.get(),is_grouping=buffer.get(),max_length=buffer.getInt(),class_name=buffer.getString();character_category_definition.push(new CharacterClass(class_id,class_name,is_always_invoke,is_grouping,max_length))}return invoke_def.init(character_category_definition),invoke_def},InvokeDefinitionMap.prototype.init=function(character_category_definition){if(null!=character_category_definition)for(var i=0;i<character_category_definition.length;i++){var character_class=character_category_definition[i];this.map[i]=character_class,this.lookup_table[character_class.class_name]=i}},InvokeDefinitionMap.prototype.getCharacterClass=function(class_id){return this.map[class_id]},InvokeDefinitionMap.prototype.lookup=function(class_name){var class_id=this.lookup_table[class_name];return null==class_id?null:class_id},InvokeDefinitionMap.prototype.toBuffer=function(){for(var buffer=new ByteBuffer,i=0;i<this.map.length;i++){var char_class=this.map[i];buffer.put(char_class.is_always_invoke),buffer.put(char_class.is_grouping),buffer.putInt(char_class.max_length),buffer.putString(char_class.class_name)}return buffer.shrink(),buffer.buffer},module.exports=InvokeDefinitionMap},{"../util/ByteBuffer.js":17,"./CharacterClass.js":8}],13:[function(require,module,exports){"use strict";var ByteBuffer=require("../util/ByteBuffer.js");function TokenInfoDictionary(){this.dictionary=new ByteBuffer(10485760),this.target_map={},this.pos_buffer=new ByteBuffer(10485760)}TokenInfoDictionary.prototype.buildDictionary=function(entries){for(var dictionary_entries={},i=0;i<entries.length;i++){var entry=entries[i];if(!(entry.length<4)){var surface_form=entry[0],left_id=entry[1],right_id=entry[2],word_cost=entry[3],feature=entry.slice(4).join(","),token_info_id;isFinite(left_id)&&isFinite(right_id)&&isFinite(word_cost)||console.log(entry),dictionary_entries[this.put(left_id,right_id,word_cost,surface_form,feature)]=surface_form}}return this.dictionary.shrink(),this.pos_buffer.shrink(),dictionary_entries},TokenInfoDictionary.prototype.put=function(left_id,right_id,word_cost,surface_form,feature){var token_info_id=this.dictionary.position,pos_id=this.pos_buffer.position;return this.dictionary.putShort(left_id),this.dictionary.putShort(right_id),this.dictionary.putShort(word_cost),this.dictionary.putInt(pos_id),this.pos_buffer.putString(surface_form+","+feature),token_info_id},TokenInfoDictionary.prototype.addMapping=function(source,target){var mapping=this.target_map[source];null==mapping&&(mapping=[]),mapping.push(target),this.target_map[source]=mapping},TokenInfoDictionary.prototype.targetMapToBuffer=function(){var buffer=new ByteBuffer,map_keys_size=Object.keys(this.target_map).length;for(var key in buffer.putInt(map_keys_size),this.target_map){var values=this.target_map[key],map_values_size=values.length;buffer.putInt(parseInt(key)),buffer.putInt(map_values_size);for(var i=0;i<values.length;i++)buffer.putInt(values[i])}return buffer.shrink()},TokenInfoDictionary.prototype.loadDictionary=function(array_buffer){return this.dictionary=new ByteBuffer(array_buffer),this},TokenInfoDictionary.prototype.loadPosVector=function(array_buffer){return this.pos_buffer=new ByteBuffer(array_buffer),this},TokenInfoDictionary.prototype.loadTargetMap=function(array_buffer){var buffer=new ByteBuffer(array_buffer);for(buffer.position=0,this.target_map={},buffer.readInt();!(buffer.buffer.length<buffer.position+1);)for(var key=buffer.readInt(),map_values_size=buffer.readInt(),i=0;i<map_values_size;i++){var value=buffer.readInt();this.addMapping(key,value)}return this},TokenInfoDictionary.prototype.getFeatures=function(token_info_id_str){var token_info_id=parseInt(token_info_id_str);if(isNaN(token_info_id))return"";var pos_id=this.dictionary.getInt(token_info_id+6);return this.pos_buffer.getString(pos_id)},module.exports=TokenInfoDictionary},{"../util/ByteBuffer.js":17}],14:[function(require,module,exports){"use strict";var TokenInfoDictionary=require("./TokenInfoDictionary.js"),CharacterDefinition=require("./CharacterDefinition.js"),ByteBuffer=require("../util/ByteBuffer.js");function UnknownDictionary(){this.dictionary=new ByteBuffer(10485760),this.target_map={},this.pos_buffer=new ByteBuffer(10485760),this.character_definition=null}UnknownDictionary.prototype=Object.create(TokenInfoDictionary.prototype),UnknownDictionary.prototype.characterDefinition=function(character_definition){return this.character_definition=character_definition,this},UnknownDictionary.prototype.lookup=function(ch){return this.character_definition.lookup(ch)},UnknownDictionary.prototype.lookupCompatibleCategory=function(ch){return this.character_definition.lookupCompatibleCategory(ch)},UnknownDictionary.prototype.loadUnknownDictionaries=function(unk_buffer,unk_pos_buffer,unk_map_buffer,cat_map_buffer,compat_cat_map_buffer,invoke_def_buffer){this.loadDictionary(unk_buffer),this.loadPosVector(unk_pos_buffer),this.loadTargetMap(unk_map_buffer),this.character_definition=CharacterDefinition.load(cat_map_buffer,compat_cat_map_buffer,invoke_def_buffer)},module.exports=UnknownDictionary},{"../util/ByteBuffer.js":17,"./CharacterDefinition.js":9,"./TokenInfoDictionary.js":13}],15:[function(require,module,exports){"use strict";var TokenizerBuilder=require("./TokenizerBuilder.js"),DictionaryBuilder=require("./util/DictionaryBuilder.js"),kuromoji={builder:function(option){return new TokenizerBuilder(option)},dictionaryBuilder:function(){return new DictionaryBuilder}};module.exports=kuromoji},{"./TokenizerBuilder.js":7,"./util/DictionaryBuilder.js":18}],16:[function(require,module,exports){"use strict";var path=require("path"),async=require("async"),DynamicDictionaries=require("../dict/DynamicDictionaries.js");function DictionaryLoader(dic_path){this.dic=new DynamicDictionaries,this.dic_path=dic_path}DictionaryLoader.prototype.loadArrayBuffer=function(file,callback){throw new Error("DictionaryLoader#loadArrayBuffer should be overwrite")},DictionaryLoader.prototype.load=function(load_callback){var dic=this.dic,dic_path=this.dic_path,loadArrayBuffer=this.loadArrayBuffer;async.parallel([function(callback){async.map(["base.dat.gz","check.dat.gz"],(function(filename,_callback){loadArrayBuffer(path.join(dic_path,filename),(function(err,buffer){if(err)return _callback(err);_callback(null,buffer)}))}),(function(err,buffers){if(err)return callback(err);var base_buffer=new Int32Array(buffers[0]),check_buffer=new Int32Array(buffers[1]);dic.loadTrie(base_buffer,check_buffer),callback(null)}))},function(callback){async.map(["tid.dat.gz","tid_pos.dat.gz","tid_map.dat.gz"],(function(filename,_callback){loadArrayBuffer(path.join(dic_path,filename),(function(err,buffer){if(err)return _callback(err);_callback(null,buffer)}))}),(function(err,buffers){if(err)return callback(err);var token_info_buffer=new Uint8Array(buffers[0]),pos_buffer=new Uint8Array(buffers[1]),target_map_buffer=new Uint8Array(buffers[2]);dic.loadTokenInfoDictionaries(token_info_buffer,pos_buffer,target_map_buffer),callback(null)}))},function(callback){loadArrayBuffer(path.join(dic_path,"cc.dat.gz"),(function(err,buffer){if(err)return callback(err);var cc_buffer=new Int16Array(buffer);dic.loadConnectionCosts(cc_buffer),callback(null)}))},function(callback){async.map(["unk.dat.gz","unk_pos.dat.gz","unk_map.dat.gz","unk_char.dat.gz","unk_compat.dat.gz","unk_invoke.dat.gz"],(function(filename,_callback){loadArrayBuffer(path.join(dic_path,filename),(function(err,buffer){if(err)return _callback(err);_callback(null,buffer)}))}),(function(err,buffers){if(err)return callback(err);var unk_buffer=new Uint8Array(buffers[0]),unk_pos_buffer=new Uint8Array(buffers[1]),unk_map_buffer=new Uint8Array(buffers[2]),cat_map_buffer=new Uint8Array(buffers[3]),compat_cat_map_buffer=new Uint32Array(buffers[4]),invoke_def_buffer=new Uint8Array(buffers[5]);dic.loadUnknownDictionaries(unk_buffer,unk_pos_buffer,unk_map_buffer,cat_map_buffer,compat_cat_map_buffer,invoke_def_buffer),callback(null)}))}],(function(err){load_callback(err,dic)}))},module.exports=DictionaryLoader},{"../dict/DynamicDictionaries.js":11,async:1,path:2}],17:[function(require,module,exports){"use strict";var stringToUtf8Bytes=function(str){for(var bytes=new Uint8Array(4*str.length),i=0,j=0;i<str.length;){var unicode_code,utf16_code=str.charCodeAt(i++);if(utf16_code>=55296&&utf16_code<=56319){var upper=utf16_code,lower=str.charCodeAt(i++);if(!(lower>=56320&&lower<=57343))return null;unicode_code=1024*(upper-55296)+65536+(lower-56320)}else unicode_code=utf16_code;unicode_code<128?bytes[j++]=unicode_code:unicode_code<2048?(bytes[j++]=unicode_code>>>6|192,bytes[j++]=63&unicode_code|128):unicode_code<65536?(bytes[j++]=unicode_code>>>12|224,bytes[j++]=unicode_code>>6&63|128,bytes[j++]=63&unicode_code|128):unicode_code<1<<21&&(bytes[j++]=unicode_code>>>18|240,bytes[j++]=unicode_code>>12&63|128,bytes[j++]=unicode_code>>6&63|128,bytes[j++]=63&unicode_code|128)}return bytes.subarray(0,j)},utf8BytesToString=function(bytes){for(var str="",code,b1,b2,b3,b4,upper,lower,i=0;i<bytes.length;)(code=(b1=bytes[i++])<128?b1:b1>>5==6?(31&b1)<<6|63&(b2=bytes[i++]):b1>>4==14?(15&b1)<<12|(63&(b2=bytes[i++]))<<6|63&(b3=bytes[i++]):(7&b1)<<18|(63&(b2=bytes[i++]))<<12|(63&(b3=bytes[i++]))<<6|63&(b4=bytes[i++]))<65536?str+=String.fromCharCode(code):(upper=55296|(code-=65536)>>10,lower=56320|1023&code,str+=String.fromCharCode(upper,lower));return str};function ByteBuffer(arg){var initial_size;if(null==arg)initial_size=1048576;else{if("number"!=typeof arg){if(arg instanceof Uint8Array)return this.buffer=arg,void(this.position=0);throw typeof arg+" is invalid parameter type for ByteBuffer constructor"}initial_size=arg}this.buffer=new Uint8Array(initial_size),this.position=0}ByteBuffer.prototype.size=function(){return this.buffer.length},ByteBuffer.prototype.reallocate=function(){var new_array=new Uint8Array(2*this.buffer.length);new_array.set(this.buffer),this.buffer=new_array},ByteBuffer.prototype.shrink=function(){return this.buffer=this.buffer.subarray(0,this.position),this.buffer},ByteBuffer.prototype.put=function(b){this.buffer.length<this.position+1&&this.reallocate(),this.buffer[this.position++]=b},ByteBuffer.prototype.get=function(index){return null==index&&(index=this.position,this.position+=1),this.buffer.length<index+1?0:this.buffer[index]},ByteBuffer.prototype.putShort=function(num){if(65535<num)throw num+" is over short value";var lower=255&num,upper=(65280&num)>>8;this.put(lower),this.put(upper)},ByteBuffer.prototype.getShort=function(index){if(null==index&&(index=this.position,this.position+=2),this.buffer.length<index+2)return 0;var lower=this.buffer[index],upper;return(this.buffer[index+1]<<8)+lower},ByteBuffer.prototype.putInt=function(num){if(4294967295<num)throw num+" is over integer value";var b0=255&num,b1=(65280&num)>>8,b2=(16711680&num)>>16,b3=(4278190080&num)>>24;this.put(b0),this.put(b1),this.put(b2),this.put(b3)},ByteBuffer.prototype.getInt=function(index){if(null==index&&(index=this.position,this.position+=4),this.buffer.length<index+4)return 0;var b0=this.buffer[index],b1=this.buffer[index+1],b2=this.buffer[index+2],b3;return(this.buffer[index+3]<<24)+(b2<<16)+(b1<<8)+b0},ByteBuffer.prototype.readInt=function(){var pos=this.position;return this.position+=4,this.getInt(pos)},ByteBuffer.prototype.putString=function(str){for(var bytes=stringToUtf8Bytes(str),i=0;i<bytes.length;i++)this.put(bytes[i]);this.put(0)},ByteBuffer.prototype.getString=function(index){var buf=[],ch;for(null==index&&(index=this.position);!(this.buffer.length<index+1)&&0!==(ch=this.get(index++));)buf.push(ch);return this.position=index,utf8BytesToString(buf)},module.exports=ByteBuffer},{}],18:[function(require,module,exports){"use strict";var doublearray=require("doublearray"),DynamicDictionaries=require("../dict/DynamicDictionaries.js"),TokenInfoDictionary=require("../dict/TokenInfoDictionary.js"),ConnectionCosts=require("../dict/ConnectionCosts.js"),UnknownDictionary=require("../dict/UnknownDictionary.js"),CharacterDefinition=require("../dict/CharacterDefinition.js");function DictionaryBuilder(){this.tid_entries=[],this.unk_entries=[],this.matrix_text="0 0",this.char_text=""}DictionaryBuilder.prototype.addTokenInfoDictionary=function(text){var new_entries=text.split(/\n/).map((function(row){return row.split(",")}));return this.tid_entries=this.tid_entries.concat(new_entries),this},DictionaryBuilder.prototype.costMatrix=function(matrix_text){return this.matrix_text=matrix_text,this},DictionaryBuilder.prototype.charDef=function(char_text){return this.char_text=char_text,this},DictionaryBuilder.prototype.unkDef=function(text){return this.unk_entries=text.split(/\n/).map((function(row){return row.split(",")})),this},DictionaryBuilder.prototype.build=function(){var dictionaries=this.buildTokenInfoDictionary(),connection_costs=this.buildConnectionCosts(),unknown_dictionary=this.buildUnknownDictionary();return new DynamicDictionaries(dictionaries.trie,dictionaries.token_info_dictionary,connection_costs,unknown_dictionary)},DictionaryBuilder.prototype.buildTokenInfoDictionary=function(){var token_info_dictionary=new TokenInfoDictionary,dictionary_entries=token_info_dictionary.buildDictionary(this.tid_entries),trie=this.buildDoubleArray();for(var token_info_id in dictionary_entries){var surface_form=dictionary_entries[token_info_id],trie_id=trie.lookup(surface_form);token_info_dictionary.addMapping(trie_id,token_info_id)}return{trie:trie,token_info_dictionary:token_info_dictionary}},DictionaryBuilder.prototype.buildUnknownDictionary=function(){var unk_dictionary=new UnknownDictionary,dictionary_entries=unk_dictionary.buildDictionary(this.unk_entries),char_def=CharacterDefinition.readCharacterDefinition(this.char_text);for(var token_info_id in unk_dictionary.characterDefinition(char_def),dictionary_entries){var class_name=dictionary_entries[token_info_id],class_id=char_def.invoke_definition_map.lookup(class_name);unk_dictionary.addMapping(class_id,token_info_id)}return unk_dictionary},DictionaryBuilder.prototype.buildConnectionCosts=function(){return ConnectionCosts.build(this.matrix_text)},DictionaryBuilder.prototype.buildDoubleArray=function(){var trie_id=0,words=this.tid_entries.map((function(entry){var surface_form;return{k:entry[0],v:trie_id++}})),builder;return doublearray.builder(1048576).build(words)},module.exports=DictionaryBuilder},{"../dict/CharacterDefinition.js":9,"../dict/ConnectionCosts.js":10,"../dict/DynamicDictionaries.js":11,"../dict/TokenInfoDictionary.js":13,"../dict/UnknownDictionary.js":14,doublearray:4}],19:[function(require,module,exports){"use strict";function IpadicFormatter(){}IpadicFormatter.prototype.formatEntry=function(word_id,position,type,features){var token={};return token.word_id=word_id,token.word_type=type,token.word_position=position,token.surface_form=features[0],token.pos=features[1],token.pos_detail_1=features[2],token.pos_detail_2=features[3],token.pos_detail_3=features[4],token.conjugated_type=features[5],token.conjugated_form=features[6],token.basic_form=features[7],token.reading=features[8],token.pronunciation=features[9],token},IpadicFormatter.prototype.formatUnknownEntry=function(word_id,position,type,features,surface_form){var token={};return token.word_id=word_id,token.word_type=type,token.word_position=position,token.surface_form=surface_form,token.pos=features[1],token.pos_detail_1=features[2],token.pos_detail_2=features[3],token.pos_detail_3=features[4],token.conjugated_type=features[5],token.conjugated_form=features[6],token.basic_form=features[7],token},module.exports=IpadicFormatter},{}],20:[function(require,module,exports){"use strict";function SurrogateAwareString(str){this.str=str,this.index_mapping=[];for(var pos=0;pos<str.length;pos++){var ch=str.charAt(pos);this.index_mapping.push(pos),SurrogateAwareString.isSurrogatePair(ch)&&pos++}this.length=this.index_mapping.length}SurrogateAwareString.prototype.slice=function(index){if(this.index_mapping.length<=index)return"";var surrogate_aware_index=this.index_mapping[index];return this.str.slice(surrogate_aware_index)},SurrogateAwareString.prototype.charAt=function(index){if(this.str.length<=index)return"";var surrogate_aware_start_index=this.index_mapping[index],surrogate_aware_end_index=this.index_mapping[index+1];return null==surrogate_aware_end_index?this.str.slice(surrogate_aware_start_index):this.str.slice(surrogate_aware_start_index,surrogate_aware_end_index)},SurrogateAwareString.prototype.charCodeAt=function(index){if(this.index_mapping.length<=index)return NaN;var surrogate_aware_index=this.index_mapping[index],upper=this.str.charCodeAt(surrogate_aware_index),lower;return upper>=55296&&upper<=56319&&surrogate_aware_index<this.str.length&&(lower=this.str.charCodeAt(surrogate_aware_index+1))>=56320&&lower<=57343?1024*(upper-55296)+lower-56320+65536:upper},SurrogateAwareString.prototype.toString=function(){return this.str},SurrogateAwareString.isSurrogatePair=function(ch){var utf16_code=ch.charCodeAt(0);return utf16_code>=55296&&utf16_code<=56319},module.exports=SurrogateAwareString},{}],21:[function(require,module,exports){"use strict";var ViterbiNode=require("./ViterbiNode.js"),ViterbiLattice=require("./ViterbiLattice.js"),SurrogateAwareString=require("../util/SurrogateAwareString.js");function ViterbiBuilder(dic){this.trie=dic.trie,this.token_info_dictionary=dic.token_info_dictionary,this.unknown_dictionary=dic.unknown_dictionary}ViterbiBuilder.prototype.build=function(sentence_str){for(var lattice=new ViterbiLattice,sentence=new SurrogateAwareString(sentence_str),key,trie_id,left_id,right_id,word_cost,pos=0;pos<sentence.length;pos++){for(var tail=sentence.slice(pos),vocabulary=this.trie.commonPrefixSearch(tail),n=0;n<vocabulary.length;n++){trie_id=vocabulary[n].v,key=vocabulary[n].k;for(var token_info_ids=this.token_info_dictionary.target_map[trie_id],i=0;i<token_info_ids.length;i++){var token_info_id=parseInt(token_info_ids[i]);left_id=this.token_info_dictionary.dictionary.getShort(token_info_id),right_id=this.token_info_dictionary.dictionary.getShort(token_info_id+2),word_cost=this.token_info_dictionary.dictionary.getShort(token_info_id+4),lattice.append(new ViterbiNode(token_info_id,word_cost,pos+1,key.length,"KNOWN",left_id,right_id,key))}}var surrogate_aware_tail=new SurrogateAwareString(tail),head_char=new SurrogateAwareString(surrogate_aware_tail.charAt(0)),head_char_class=this.unknown_dictionary.lookup(head_char.toString());if(null==vocabulary||0===vocabulary.length||1===head_char_class.is_always_invoke){if(key=head_char,1===head_char_class.is_grouping&&1<surrogate_aware_tail.length)for(var k=1;k<surrogate_aware_tail.length;k++){var next_char=surrogate_aware_tail.charAt(k),next_char_class=this.unknown_dictionary.lookup(next_char);if(head_char_class.class_name!==next_char_class.class_name)break;key+=next_char}for(var unk_ids=this.unknown_dictionary.target_map[head_char_class.class_id],j=0;j<unk_ids.length;j++){var unk_id=parseInt(unk_ids[j]);left_id=this.unknown_dictionary.dictionary.getShort(unk_id),right_id=this.unknown_dictionary.dictionary.getShort(unk_id+2),word_cost=this.unknown_dictionary.dictionary.getShort(unk_id+4),lattice.append(new ViterbiNode(unk_id,word_cost,pos+1,key.length,"UNKNOWN",left_id,right_id,key.toString()))}}}return lattice.appendEos(),lattice},module.exports=ViterbiBuilder},{"../util/SurrogateAwareString.js":20,"./ViterbiLattice.js":22,"./ViterbiNode.js":23}],22:[function(require,module,exports){"use strict";var ViterbiNode=require("./ViterbiNode.js");function ViterbiLattice(){this.nodes_end_at=[],this.nodes_end_at[0]=[new ViterbiNode("BOS",0,0,0,"BOS",0,0)],this.eos_pos=1}ViterbiLattice.prototype.append=function(node){var last_pos=node.start_pos+node.length-1;this.eos_pos<last_pos&&(this.eos_pos=last_pos);var prev_nodes=this.nodes_end_at[last_pos];null==prev_nodes&&(prev_nodes=[]),prev_nodes.push(node),this.nodes_end_at[last_pos]=prev_nodes},ViterbiLattice.prototype.appendEos=function(){var last_index=this.nodes_end_at.length;this.eos_pos++,this.nodes_end_at[last_index]=[new ViterbiNode("EOS",0,this.eos_pos,0,"EOS",0,0)]},module.exports=ViterbiLattice},{"./ViterbiNode.js":23}],23:[function(require,module,exports){"use strict";function ViterbiNode(node_name,node_cost,start_pos,length,type,left_id,right_id,surface_form){this.name=node_name,this.cost=node_cost,this.start_pos=start_pos,this.length=length,this.left_id=left_id,this.right_id=right_id,this.prev=null,this.surface_form=surface_form,this.shortest_cost="BOS"===type?0:Number.MAX_VALUE,this.type=type}module.exports=ViterbiNode},{}],24:[function(require,module,exports){"use strict";function ViterbiSearcher(connection_costs){this.connection_costs=connection_costs}ViterbiSearcher.prototype.search=function(lattice){return lattice=this.forward(lattice),this.backward(lattice)},ViterbiSearcher.prototype.forward=function(lattice){var i,j,k;for(i=1;i<=lattice.eos_pos;i++){var nodes=lattice.nodes_end_at[i];if(null!=nodes)for(j=0;j<nodes.length;j++){var node=nodes[j],cost=Number.MAX_VALUE,shortest_prev_node,prev_nodes=lattice.nodes_end_at[node.start_pos-1];if(null!=prev_nodes){for(k=0;k<prev_nodes.length;k++){var prev_node=prev_nodes[k],edge_cost;null==node.left_id||null==prev_node.right_id?(console.log("Left or right is null"),edge_cost=0):edge_cost=this.connection_costs.get(prev_node.right_id,node.left_id);var _cost=prev_node.shortest_cost+edge_cost+node.cost;_cost<cost&&(shortest_prev_node=prev_node,cost=_cost)}node.prev=shortest_prev_node,node.shortest_cost=cost}}}return lattice},ViterbiSearcher.prototype.backward=function(lattice){var shortest_path=[],eos,node_back=lattice.nodes_end_at[lattice.nodes_end_at.length-1][0].prev;if(null==node_back)return[];for(;"BOS"!==node_back.type;){if(shortest_path.push(node_back),null==node_back.prev)return[];node_back=node_back.prev}return shortest_path.reverse()},module.exports=ViterbiSearcher},{}]},{},[15])(15)}));